{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "version": "4.0.0",
  "description": "RCC v4.0 安全配置",
  "lastUpdated": "2024-08-15T00:00:00Z",

  "encryption": {
    "enabled": true,
    "algorithm": "aes-256-gcm",
    "keyDerivation": {
      "algorithm": "pbkdf2",
      "iterations": 100000,
      "saltLength": 32,
      "keyLength": 32
    },
    "encryptedFields": [
      "apiKey",
      "secret",
      "token",
      "password",
      "privateKey"
    ]
  },

  "keyManagement": {
    "provider": "environment",
    "masterKeyEnvVar": "RCC_MASTER_KEY",
    "keyRotation": {
      "enabled": false,
      "intervalDays": 90
    },
    "backup": {
      "enabled": false,
      "location": "${RCC_KEY_BACKUP_PATH}"
    }
  },

  "authentication": {
    "apiKey": {
      "enabled": true,
      "header": "Authorization",
      "prefix": "Bearer",
      "validation": {
        "minLength": 32,
        "pattern": "^[A-Za-z0-9_-]+$"
      }
    },
    "jwt": {
      "enabled": false,
      "secret": "${RCC_JWT_SECRET}",
      "expiresIn": "1h",
      "algorithm": "HS256"
    }
  },

  "authorization": {
    "rbac": {
      "enabled": false,
      "roles": {
        "admin": {
          "permissions": ["*"]
        },
        "user": {
          "permissions": ["read", "execute"]
        },
        "readonly": {
          "permissions": ["read"]
        }
      }
    }
  },

  "rateLimit": {
    "enabled": true,
    "global": {
      "windowMs": 60000,
      "maxRequests": 100
    },
    "perProvider": {
      "windowMs": 60000,
      "maxRequests": 50
    },
    "perIP": {
      "windowMs": 60000,
      "maxRequests": 30
    }
  },

  "inputValidation": {
    "enabled": true,
    "maxRequestSize": "10MB",
    "allowedContentTypes": [
      "application/json",
      "text/plain"
    ],
    "sanitization": {
      "enabled": true,
      "removeScripts": true,
      "trimWhitespace": true
    },
    "requestValidation": {
      "maxMessageLength": 100000,
      "maxMessagesCount": 50,
      "allowedRoles": ["user", "assistant", "system", "tool"]
    }
  },

  "logging": {
    "level": "info",
    "sensitiveFieldFiltering": {
      "enabled": true,
      "fields": [
        "apiKey",
        "authorization",
        "password",
        "secret",
        "token"
      ],
      "replacement": "[REDACTED]"
    },
    "auditLog": {
      "enabled": true,
      "events": [
        "authentication_failure",
        "authorization_failure",
        "configuration_change",
        "provider_error",
        "security_violation"
      ]
    }
  },

  "headers": {
    "security": {
      "contentSecurityPolicy": "default-src 'self'",
      "xFrameOptions": "DENY", 
      "xContentTypeOptions": "nosniff",
      "referrerPolicy": "strict-origin-when-cross-origin",
      "permissionsPolicy": "geolocation=(), microphone=(), camera=()"
    },
    "cors": {
      "enabled": true,
      "origins": ["${RCC_ALLOWED_ORIGINS}"],
      "methods": ["GET", "POST", "OPTIONS"],
      "allowedHeaders": ["Content-Type", "Authorization"],
      "credentials": false
    }
  },

  "errorHandling": {
    "hideInternalErrors": true,
    "sanitizeErrorMessages": true,
    "logFullErrors": true,
    "genericErrorMessage": "An error occurred while processing your request"
  },

  "monitoring": {
    "securityEvents": {
      "enabled": true,
      "alerting": {
        "enabled": false,
        "webhook": "${RCC_SECURITY_WEBHOOK}"
      }
    },
    "metricsCollection": {
      "includeSecurityMetrics": true,
      "anonymizeData": true
    }
  },

  "compliance": {
    "dataRetention": {
      "logRetentionDays": 30,
      "configBackupRetentionDays": 90
    },
    "privacy": {
      "anonymizeIPs": true,
      "dataMinimization": true
    }
  },

  "development": {
    "allowInsecureConnections": false,
    "debugMode": false,
    "testDataGeneration": false
  }
}