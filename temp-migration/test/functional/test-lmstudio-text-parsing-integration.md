# LM Studio 文本解析集成测试

## 测试用例
验证 LM Studio 提供商的文本中工具调用解析和缓冲处理功能

## 测试目标
1. **基本工具调用提取** - 验证从文本中提取单个工具调用
2. **复杂文本解析** - 验证处理包含多个工具调用的复杂文本
3. **响应流水线集成** - 验证与 v3.0 六层架构的集成
4. **边缘情况处理** - 验证错误输入和特殊情况的处理
5. **性能基准测试** - 验证大量工具调用的处理性能

## 测试组件
- **LMStudioBufferedProcessor** - 核心缓冲处理器
- **ResponsePipeline** - v3.0 响应流水线
- **LayerInterface** - 六层架构接口实现

## 测试数据特征
- **LM Studio 特有格式**: "Tool call: FunctionName(arguments)"
- **包含特殊标记**: "⏺ Tool call:" 格式
- **JSON 参数解析**: 支持复杂 JSON 参数
- **混合内容**: 文本和工具调用混合的响应

## 预期结果
- **工具调用提取**: 正确识别和提取工具调用
- **格式转换**: 转换为 Anthropic 兼容的流式事件
- **错误处理**: 优雅处理无效输入
- **性能要求**: 平均处理时间 < 100ms

## 最近执行记录

### 执行时间: [待更新]
### 执行状态: [待执行]
### 执行时长: [待测试]
### 日志文件: [待生成]

## 历史执行记录
- **创建时间**: 2025-08-12
- **创建目的**: LM Studio 文本解析功能验证
- **相关文件**: 
  - `src/v3/provider/openai-compatible/lmstudio-buffered-processor.ts`
  - `src/v3/pipeline/response-pipeline.ts`
  - `test/functional/test-lmstudio-text-parsing-integration.js`

## 相关技术
- **ES 模块动态导入**: 支持 v3.0 架构的 ES 模块
- **正则表达式模式匹配**: 工具调用模式识别
- **事件流生成**: Anthropic SSE 格式生成
- **缓冲式处理**: 完整响应缓冲和批量处理

## 故障排除
- **导入错误**: 确保 ES 模块路径正确
- **工具调用未检测**: 检查文本格式和正则表达式
- **性能问题**: 优化大量工具调用的处理逻辑
- **格式转换错误**: 验证 Anthropic 事件格式的正确性