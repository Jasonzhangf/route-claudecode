{
  "timestamp": "2025-07-26T12:49:03.229Z",
  "testType": "CodeWhisperer认证测试",
  "summary": {
    "total": 4,
    "passed": 3,
    "failed": 1,
    "successRate": 75
  },
  "authResults": [
    {
      "name": "token-file-check",
      "timestamp": "2025-07-26T12:49:00.166Z",
      "success": true,
      "message": "Token文件检查通过",
      "details": {
        "path": "/Users/fanzhang/.aws/sso/cache/kiro-auth-token.json",
        "exists": true,
        "mtime": "2025-07-26T12:40:33.698Z",
        "isRecent": true,
        "size": 510
      }
    },
    {
      "name": "token-content-validation",
      "timestamp": "2025-07-26T12:49:00.166Z",
      "success": true,
      "message": "Token内容验证完成",
      "details": {
        "hasAccessToken": true,
        "hasRefreshToken": true,
        "accessTokenLength": 232,
        "refreshTokenLength": 233,
        "accessTokenValid": true,
        "refreshTokenValid": true
      }
    },
    {
      "name": "server-auth-integration",
      "timestamp": "2025-07-26T12:49:01.890Z",
      "success": [],
      "message": "本地服务器认证测试完成",
      "details": {
        "status": 200,
        "model": "gemini-2.5-flash",
        "hasContent": false,
        "responseId": "chatcmpl-20250726204900857777095WgjZfhyO",
        "usage": {
          "input_tokens": 12,
          "output_tokens": 49
        }
      }
    },
    {
      "name": "direct-connection-test",
      "timestamp": "2025-07-26T12:49:03.228Z",
      "success": false,
      "message": "CodeWhisperer直接连接失败: Request failed with status code 400",
      "details": {
        "errorType": "unknown",
        "status": 400,
        "statusText": "Bad Request",
        "endpoint": "https://codewhisperer.us-east-1.amazonaws.com",
        "hasToken": true,
        "tokenLength": 232
      }
    }
  ],
  "configuration": {
    "tokenPath": "/Users/fanzhang/.aws/sso/cache/kiro-auth-token.json",
    "codewhispererEndpoint": "https://codewhisperer.us-east-1.amazonaws.com",
    "profileArn": "arn:aws:codewhisperer:us-east-1:699475941385:profile/test-profile",
    "localServerEndpoint": "http://127.0.0.1:3456",
    "testRequest": {
      "model": "CLAUDE_SONNET_4_20250514_V1_0",
      "messages": [
        {
          "role": "user",
          "content": "Hello, this is a CodeWhisperer authentication test"
        }
      ],
      "max_tokens": 50
    }
  },
  "recommendations": [
    {
      "type": "direct-connection",
      "description": "CodeWhisperer直接连接失败",
      "suggestion": "检查网络连接、profile ARN配置和token有效性",
      "priority": "medium"
    }
  ],
  "environment": {
    "nodeVersion": "v22.16.0",
    "platform": "darwin",
    "tokenPath": "/Users/fanzhang/.aws/sso/cache/kiro-auth-token.json",
    "hasTokenFile": true
  }
}