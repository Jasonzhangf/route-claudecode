# LMStudio 综合验证系统

## 测试用例
LMStudio配置安装状态验证和自动化工具调用解析系统

## 测试目标
- 自动捕获数据的系统，出错时可以溯源
- 工具解析预处理阶段的自动化测试程序
- 自动扫描捕获数据文件夹，发现解析错误
- 验证路由系统和Claude Code客户端连接正常
- 验证OpenAI协议响应和LMStudio工具调用处理

## 测试阶段

### 阶段1: 环境准备和数据库初始化
- **目标**: 确保测试环境准备完毕
- **检查项**:
  - 创建必要的目录结构
  - 验证LMStudio配置文件存在
  - 初始化数据库捕获系统
  - 检查rcc3命令可用性

### 阶段2: LMStudio 服务启动验证
- **目标**: 验证LMStudio服务正常启动
- **检查项**:
  - 检查端口占用并清理冲突进程
  - 启动LMStudio服务 (端口5506)
  - 验证服务健康状态

### 阶段3: 数据捕获系统启动
- **目标**: 建立自动化数据捕获机制
- **检查项**:
  - 清理旧的捕获数据
  - 启动数据捕获监控
  - 验证数据捕获配置

### 阶段4: 工具调用预处理测试
- **目标**: 验证工具调用解析逻辑正确性
- **检查项**:
  - 基本工具调用测试
  - 复杂工具调用测试
  - 多轮对话工具调用测试
  - 验证工具调用解析准确性 (>=90%)

### 阶段5: 路由和客户端连接测试
- **目标**: 验证完整的路由链路正常工作
- **检查项**:
  - Claude Code客户端连接测试
  - 路由正确性测试
  - OpenAI协议兼容性测试
  - LMStudio后端响应测试

### 阶段6: 自动数据分析和问题检测
- **目标**: 自动化发现和分析问题
- **检查项**:
  - 扫描捕获的数据文件
  - 分析工具调用模式
  - 检测解析错误
  - 生成自动化修复建议

### 阶段7: 修复验证和回归测试
- **目标**: 验证修复效果和系统稳定性
- **检查项**:
  - 应用已识别的修复
  - 重新运行核心测试
  - 验证修复效果 (>=80%改善)

## 配置信息
- **LMStudio端口**: 5506
- **配置文件**: config-lmstudio-v3-5506.json
- **测试模型**: qwen3-30b, glm-4.5-air
- **数据捕获路径**: ~/.route-claude-code/database/captures

## 最近执行记录

### 执行时间: 待执行
- **状态**: 新建测试
- **执行时长**: 待测量
- **日志文件**: 待生成

## 历史执行记录
- 无历史记录

## 相关文件
- **测试脚本**: test/functional/test-lmstudio-comprehensive-validation.js
- **输出目录**: test/output/functional/test-lmstudio-data/
- **配置目录**: ~/.route-claudecode/config/v3/single-provider/

## 预期结果
- 所有7个阶段应该通过
- 工具调用解析准确性应该 >= 90%
- 修复效果验证应该 >= 80%
- 自动生成问题修复建议
- 完整的数据捕获和分析流程运行正常

## 故障排除
- 如果rcc3命令不可用，运行 `./scripts/install-v3.sh`
- 如果端口被占用，将自动清理冲突进程
- 如果LMStudio未启动，检查LMStudio桌面应用是否运行
- 如果配置文件不存在，检查配置目录路径