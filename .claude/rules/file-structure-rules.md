# ğŸ“ æ–‡ä»¶ç»“æ„è§„åˆ™ (File Structure Rules)

## ğŸ—ï¸ é¡¹ç›®ç›®å½•ç»“æ„æ ‡å‡† (Project Directory Standards)

### æ ¹ç›®å½•ç»“æ„
```
claude-code-router/
â”œâ”€â”€ .claude/                    # è§„åˆ™ç®¡ç†ç³»ç»Ÿ
â”‚   â”œâ”€â”€ rules/                  # åˆ†ç±»è§„åˆ™æ–‡ä»¶
â”‚   â””â”€â”€ project-details/        # è¯¦ç»†æŠ€æœ¯æ–‡æ¡£
â”œâ”€â”€ src/                        # æºä»£ç  (å…­å±‚æ¶æ„)
â”œâ”€â”€ test/                       # æµ‹è¯•ç³»ç»Ÿ (æŒ‰åŠŸèƒ½åˆ†ç±»)
â”œâ”€â”€ tools/                      # é•¿æœŸç»´æŠ¤æµ‹è¯•å·¥å…· (â­ NEW)
â”œâ”€â”€ docs/                       # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ examples/                   # ç¤ºä¾‹å’Œå‚è€ƒå®ç°
â”œâ”€â”€ config/                     # é…ç½®æ–‡ä»¶æ¨¡æ¿
â”œâ”€â”€ scripts/                    # å·¥å…·è„šæœ¬
â””â”€â”€ dist/                       # æ„å»ºè¾“å‡º
```

### æ ¸å¿ƒç›®å½•è¯¦è§£

#### .claude/ - è§„åˆ™ç®¡ç†ç³»ç»Ÿ
```
.claude/
â”œâ”€â”€ rules/
â”‚   â”œâ”€â”€ programming-rules.md           # æ ¸å¿ƒç¼–ç¨‹è§„èŒƒ
â”‚   â”œâ”€â”€ architecture-rules.md          # æ¶æ„è®¾è®¡è§„åˆ™
â”‚   â”œâ”€â”€ testing-system-rules.md        # æµ‹è¯•æ¡†æ¶è§„èŒƒ
â”‚   â”œâ”€â”€ file-structure-rules.md        # æ–‡ä»¶ç»„ç»‡è§„èŒƒ
â”‚   â”œâ”€â”€ deployment-rules.md            # éƒ¨ç½²å’Œå‘å¸ƒè§„åˆ™
â”‚   â””â”€â”€ memory-system-rules.md         # çŸ¥è¯†ç®¡ç†è§„åˆ™
â””â”€â”€ project-details/
    â”œâ”€â”€ provider-implementations/      # å„Providerå®ç°ç»†èŠ‚
    â”œâ”€â”€ routing-strategies/            # è·¯ç”±ç­–ç•¥æ–‡æ¡£
    â”œâ”€â”€ testing-strategies/           # æµ‹è¯•ç­–ç•¥æ–‡æ¡£
    â””â”€â”€ performance-analysis/         # æ€§èƒ½åˆ†ææŠ¥å‘Š
```

#### tools/ - é•¿æœŸç»´æŠ¤æµ‹è¯•å·¥å…· (â­ NEW)
```
tools/
â”œâ”€â”€ config.json                       # å…¨å±€å·¥å…·é…ç½®
â”œâ”€â”€ README.md                          # å·¥å…·ç³»ç»Ÿæ€»è§ˆ
â”œâ”€â”€ log-parser/                        # æ—¥å¿—è§£æå·¥å…·é›†
â”‚   â”œâ”€â”€ server-response-extractor/     # æœåŠ¡å™¨å“åº”æ•°æ®æå–å™¨
â”‚   â”œâ”€â”€ provider-data-classifier/      # Provideræ•°æ®åˆ†ç±»å™¨
â”‚   â””â”€â”€ time-series-analyzer/         # æ—¶åºæ•°æ®åˆ†æå™¨
â”œâ”€â”€ visualization/                     # å¯è§†åŒ–å·¥å…·é›†
â”‚   â”œâ”€â”€ sequence-diagram-generator/    # æ—¶åºå›¾ç”Ÿæˆå™¨
â”‚   â”œâ”€â”€ request-flow-visualizer/       # è¯·æ±‚æµç¨‹å¯è§†åŒ–å™¨
â”‚   â””â”€â”€ performance-charts/           # æ€§èƒ½å›¾è¡¨ç”Ÿæˆå™¨
â”œâ”€â”€ data-extraction/                   # æ•°æ®æå–å·¥å…·é›†
â”‚   â”œâ”€â”€ provider-response-parser/      # Providerå“åº”è§£æå™¨
â”‚   â”œâ”€â”€ tool-call-analyzer/           # å·¥å…·è°ƒç”¨åˆ†æå™¨
â”‚   â””â”€â”€ finish-reason-tracker/        # å®ŒæˆåŸå› è¿½è¸ªå™¨
â””â”€â”€ utilities/                         # é€šç”¨å·¥å…·é›†
    â”œâ”€â”€ config-validator/             # é…ç½®éªŒè¯å™¨
    â”œâ”€â”€ test-data-generator/          # æµ‹è¯•æ•°æ®ç”Ÿæˆå™¨
    â””â”€â”€ performance-profiler/         # æ€§èƒ½åˆ†æå™¨
```

**å·¥å…·ç›®å½•å¼ºåˆ¶è§„èŒƒ**:
- **ç»Ÿä¸€ç®¡ç†**: æ‰€æœ‰é•¿æœŸç»´æŠ¤çš„æµ‹è¯•å·¥å…·å¿…é¡»æ”¾åœ¨ `tools/` ç›®å½•
- **åˆ†ç±»ç»„ç»‡**: æŒ‰åŠŸèƒ½åˆ†ç±»åˆ°å­ç›®å½•ï¼ˆlog-parser, visualization, data-extraction, utilitiesï¼‰
- **æ ‡å‡†åŒ–**: æ¯ä¸ªå·¥å…·éƒ½æœ‰ç‹¬ç«‹ç›®å½•å’Œå®Œæ•´æ–‡æ¡£
- **é›†æˆæ€§**: æ‰€æœ‰å·¥å…·æ”¯æŒç»Ÿä¸€é…ç½®å’Œè°ƒç”¨æ–¹å¼

## ğŸ¯ å…­å±‚æ¶æ„æºç ç»„ç»‡ (Six-Layer Source Organization)

### src/ ç›®å½•ç»“æ„
```
src/
â”œâ”€â”€ input/                      # è¾“å…¥æ ¼å¼æ¨¡å—
â”‚   â”œâ”€â”€ anthropic/             # Anthropicæ ¼å¼å¤„ç†
â”‚   â”‚   â”œâ”€â”€ index.ts           # æ¨¡å—å…¥å£
â”‚   â”‚   â”œâ”€â”€ processor.ts       # è¯·æ±‚å¤„ç†å™¨
â”‚   â”‚   â””â”€â”€ validator.ts       # æ ¼å¼éªŒè¯å™¨
â”‚   â”œâ”€â”€ openai/                # OpenAIæ ¼å¼å¤„ç† (Mock)
â”‚   â””â”€â”€ gemini/                # Geminiæ ¼å¼å¤„ç† (Mock)
â”œâ”€â”€ routing/                   # æ¨¡å‹è·¯ç”±æ¨¡å—
â”‚   â”œâ”€â”€ engine.ts              # æ ¸å¿ƒè·¯ç”±å¼•æ“
â”‚   â”œâ”€â”€ provider-manager.ts    # Providerç®¡ç†å™¨
â”‚   â”œâ”€â”€ provider-expander.ts   # Provideræ‰©å±•å™¨
â”‚   â””â”€â”€ index.ts              # è·¯ç”±æ¨¡å—å…¥å£
â”œâ”€â”€ output/                    # è¾“å‡ºæ ¼å¼æ¨¡å—
â”‚   â”œâ”€â”€ anthropic/             # Anthropicæ ¼å¼è¾“å‡º
â”‚   â””â”€â”€ openai/                # OpenAIæ ¼å¼è¾“å‡º
â”œâ”€â”€ providers/                 # æä¾›å•†æ¨¡å—
â”‚   â”œâ”€â”€ anthropic/             # Anthropic Provider
â”‚   â”œâ”€â”€ codewhisperer/         # CodeWhisperer Provider
â”‚   â”œâ”€â”€ openai/                # OpenAI Provider
â”‚   â”œâ”€â”€ gemini/                # Gemini Provider
â”‚   â””â”€â”€ common/                # é€šç”¨å·¥å…·
â”œâ”€â”€ utils/                     # å·¥å…·æ¨¡å—
â”œâ”€â”€ types/                     # ç±»å‹å®šä¹‰
â””â”€â”€ server.ts                  # æœåŠ¡å™¨å…¥å£
```

### Provideræ¨¡å—ç»„ç»‡è§„èŒƒ

æ¯ä¸ªProviderå¿…é¡»åŒ…å«ä»¥ä¸‹æ ‡å‡†æ–‡ä»¶ï¼š
```
providers/[provider-name]/
â”œâ”€â”€ index.ts          # Providerå…¥å£å’Œæ¥å£å®ç°
â”œâ”€â”€ client.ts         # HTTPå®¢æˆ·ç«¯å’ŒAPIè°ƒç”¨
â”œâ”€â”€ auth.ts           # è®¤è¯å’ŒTokenç®¡ç†
â”œâ”€â”€ converter.ts      # æ ¼å¼è½¬æ¢å™¨
â”œâ”€â”€ parser.ts         # å“åº”è§£æå™¨
â””â”€â”€ types.ts          # Providerä¸“ç”¨ç±»å‹å®šä¹‰
```

## ğŸ§ª æµ‹è¯•ç›®å½•ç»„ç»‡è§„èŒƒ (Test Directory Standards)

### test/ ç›®å½•ç»“æ„
```
test/
â”œâ”€â”€ functional/              # åŠŸèƒ½æµ‹è¯•
â”‚   â”œâ”€â”€ test-[åŠŸèƒ½].js       # åŠŸèƒ½æµ‹è¯•è„šæœ¬
â”‚   â””â”€â”€ test-[åŠŸèƒ½].md       # å¯¹åº”æµ‹è¯•æ–‡æ¡£
â”œâ”€â”€ integration/             # é›†æˆæµ‹è¯•
â”œâ”€â”€ pipeline/               # æµæ°´çº¿æµ‹è¯•
â”‚   â”œâ”€â”€ test-step[N]-[åŠŸèƒ½].js  # 6æ­¥æµæ°´çº¿æµ‹è¯•
â”‚   â””â”€â”€ run-pipeline.sh     # æµæ°´çº¿è¿è¡Œå™¨
â”œâ”€â”€ performance/            # æ€§èƒ½æµ‹è¯•
â”œâ”€â”€ unit/                   # å•å…ƒæµ‹è¯•
â”œâ”€â”€ debug/                  # è°ƒè¯•æµ‹è¯•
â”‚   â”œâ”€â”€ debug-[é—®é¢˜].js     # è°ƒè¯•è„šæœ¬
â”‚   â”œâ”€â”€ debug-[é—®é¢˜].md     # è°ƒè¯•è®°å½•
â”‚   â””â”€â”€ debug-output/       # è°ƒè¯•è¾“å‡ºæ•°æ®
â””â”€â”€ docs/                   # æµ‹è¯•æ–‡æ¡£
```

### æµ‹è¯•æ–‡ä»¶å‘½åè§„èŒƒ
- **åŠŸèƒ½æµ‹è¯•**: `test-[ä¸€å¥è¯åŠŸèƒ½æè¿°].js/md`
- **æµæ°´çº¿æµ‹è¯•**: `test-step[1-6]-[æ­¥éª¤åŠŸèƒ½].js/md`
- **ç»„ä»¶æµ‹è¯•**: `test-[ç»„ä»¶å]-[åŠŸèƒ½].js/md`
- **è°ƒè¯•è„šæœ¬**: `debug-[é—®é¢˜å…³é”®è¯].js/md`
- **æ€§èƒ½æµ‹è¯•**: `test-[ç»„ä»¶]-performance.js/md`

## ğŸ“ é…ç½®æ–‡ä»¶ç»„ç»‡ (Configuration File Organization)

### é…ç½®æ–‡ä»¶ä½ç½®
```
é¡¹ç›®æ ¹ç›®å½•/
â”œâ”€â”€ config.sample.json          # é…ç½®æ¨¡æ¿
â”œâ”€â”€ config.production.json      # ç”Ÿäº§ç¯å¢ƒé…ç½®
â””â”€â”€ config/
    â”œâ”€â”€ test-config.json        # æµ‹è¯•é…ç½®
    â””â”€â”€ comparison-config.json  # å¯¹æ¯”æµ‹è¯•é…ç½®

ç”¨æˆ·é…ç½®ç›®å½•/
~/.route-claude-code/
â”œâ”€â”€ config.json                 # ä¸»é…ç½®æ–‡ä»¶
â”œâ”€â”€ logs/                       # æ—¥å¿—ç›®å½•
â””â”€â”€ database/                   # æ•°æ®æ•è·ç›®å½•
```

### é…ç½®æ–‡ä»¶å‘½åè§„èŒƒ
- **ç¯å¢ƒé…ç½®**: `config.[ç¯å¢ƒ].json`
- **åŠŸèƒ½é…ç½®**: `[åŠŸèƒ½]-config.json`
- **æµ‹è¯•é…ç½®**: `test-[åœºæ™¯]-config.json`

## ğŸ“‹ æ–‡æ¡£ç»„ç»‡è§„èŒƒ (Documentation Standards)

### docs/ ç›®å½•ç»“æ„
```
docs/
â”œâ”€â”€ API-KEY-ROTATION.md         # APIå¯†é’¥è½®æ¢æ–‡æ¡£
â”œâ”€â”€ LOAD_BALANCING.md          # è´Ÿè½½å‡è¡¡æ–‡æ¡£
â”œâ”€â”€ MULTI_PROVIDER_ROUTING.md  # å¤šProviderè·¯ç”±æ–‡æ¡£
â”œâ”€â”€ TOOL_CALL_FIX.md           # å·¥å…·è°ƒç”¨ä¿®å¤æ–‡æ¡£
â””â”€â”€ [åŠŸèƒ½]-strategy.md          # å„åŠŸèƒ½ç­–ç•¥æ–‡æ¡£
```

### æ–‡æ¡£å‘½åè§„èŒƒ
- **æŠ€æœ¯æ–‡æ¡£**: `[åŠŸèƒ½åç§°].md` (å…¨å¤§å†™ï¼Œä¸‹åˆ’çº¿åˆ†éš”)
- **ç­–ç•¥æ–‡æ¡£**: `[ç­–ç•¥å]-strategy.md`
- **ä¿®å¤æ–‡æ¡£**: `[é—®é¢˜å]-fix.md`
- **åˆ†ææŠ¥å‘Š**: `[åˆ†æå¯¹è±¡]-analysis.md`

## ğŸ”§ è„šæœ¬å’Œå·¥å…·ç»„ç»‡ (Scripts and Tools Organization)

### æ ¹ç›®å½•è„šæœ¬
```
é¡¹ç›®æ ¹ç›®å½•/
â”œâ”€â”€ build.sh              # æ„å»ºè„šæœ¬
â”œâ”€â”€ start-dev.sh          # å¼€å‘å¯åŠ¨è„šæœ¬
â”œâ”€â”€ test-runner.sh        # æµ‹è¯•è¿è¡Œå™¨
â”œâ”€â”€ install-local.sh      # æœ¬åœ°å®‰è£…è„šæœ¬
â”œâ”€â”€ rcc                   # ä¸»å‘½ä»¤è¡Œå·¥å…·
â””â”€â”€ fix-and-test.sh       # ä¿®å¤å’Œæµ‹è¯•ä¸€ä½“åŒ–è„šæœ¬
```

### è„šæœ¬å‘½åè§„èŒƒ
- **æ„å»ºè„šæœ¬**: `build[-ç¯å¢ƒ].sh`
- **å¯åŠ¨è„šæœ¬**: `start-[æ¨¡å¼].sh`
- **æµ‹è¯•è„šæœ¬**: `test-[åŠŸèƒ½].sh`
- **å·¥å…·è„šæœ¬**: `[åŠŸèƒ½]-[æ“ä½œ].sh`

## ğŸ“¦ æ„å»ºè¾“å‡ºç»„ç»‡ (Build Output Organization)

### dist/ ç›®å½•ç»“æ„
```
dist/
â”œâ”€â”€ cli.js              # ä¸»CLIå…¥å£ (å¯æ‰§è¡Œ)
â”œâ”€â”€ server.js           # æœåŠ¡å™¨å…¥å£
â”œâ”€â”€ [æ¨¡å—]/             # å„æ¨¡å—ç¼–è¯‘è¾“å‡º
â””â”€â”€ types/              # ç±»å‹å®šä¹‰æ–‡ä»¶
```

### æ„å»ºæ–‡ä»¶è§„èŒƒ
- **ä¸»å…¥å£**: `cli.js` (å¿…é¡»åŒ…å«shebangå¤´)
- **æ¨¡å—è¾“å‡º**: ä¿æŒæºç ç›®å½•ç»“æ„
- **ç±»å‹æ–‡ä»¶**: `.d.ts` ç±»å‹å®šä¹‰æ–‡ä»¶

## ğŸ—„ï¸ æ•°æ®å­˜å‚¨ç»„ç»‡ (Data Storage Organization)

### æ•°æ®ç›®å½•ç»“æ„
```
~/.route-claude-code/database/
â”œâ”€â”€ captures/              # å®æ—¶æ•°æ®æ•è·
â”‚   â””â”€â”€ YYYY-MM-DD/       # æŒ‰æ—¥æœŸç»„ç»‡
â”œâ”€â”€ pipeline-tests/        # æµæ°´çº¿æµ‹è¯•æ•°æ®
â”œâ”€â”€ [provider-name]/       # æŒ‰Provideråˆ†ç±»
â”œâ”€â”€ daily-aggregates/      # æ—¥èšåˆæ•°æ®
â””â”€â”€ archives/              # é•¿æœŸå½’æ¡£
```

### æ•°æ®æ–‡ä»¶å‘½å
- **æ•è·æ•°æ®**: `session-[session-id]-[request-id].json`
- **æµ‹è¯•æ•°æ®**: `[test-name]-[timestamp].json`
- **èšåˆæ•°æ®**: `[provider]-[date]-aggregate.json`
- **å½’æ¡£æ•°æ®**: `[date]-[type]-archive.tar.gz`

## ğŸš¨ æ–‡ä»¶åˆ›å»ºè§„åˆ™ (File Creation Rules)

### å¼ºåˆ¶è§„åˆ™
1. **ç¦æ­¢åˆ›å»ºå†—ä½™æ–‡ä»¶**: ä¼˜å…ˆç¼–è¾‘ç°æœ‰æ–‡ä»¶è€Œéåˆ›å»ºæ–°æ–‡ä»¶
2. **ç¦æ­¢ä¸»åŠ¨åˆ›å»ºæ–‡æ¡£**: é™¤éç”¨æˆ·æ˜ç¡®è¦æ±‚ï¼Œå¦åˆ™ä¸åˆ›å»º.mdæ–‡ä»¶
3. **éµå¾ªå‘½åè§„èŒƒ**: æ‰€æœ‰æ–°æ–‡ä»¶å¿…é¡»éµå¾ªæ—¢å®šå‘½åè§„èŒƒ
4. **ç»´æŠ¤ç›®å½•ç»“æ„**: æ–°æ–‡ä»¶å¿…é¡»æ”¾åœ¨æ­£ç¡®çš„ç›®å½•ä½ç½®

### æ–‡ä»¶åˆ›å»ºæ£€æŸ¥æ¸…å•
- [ ] æ£€æŸ¥æ˜¯å¦å·²æœ‰ç±»ä¼¼åŠŸèƒ½çš„æ–‡ä»¶å¯ä»¥ç¼–è¾‘
- [ ] ç¡®è®¤æ–‡ä»¶åç¬¦åˆå‘½åè§„èŒƒ
- [ ] éªŒè¯æ–‡ä»¶ä½ç½®ç¬¦åˆç›®å½•ç»“æ„è§„èŒƒ
- [ ] æ·»åŠ å¿…è¦çš„æ–‡ä»¶å¤´ä¿¡æ¯ï¼ˆä½œè€…ã€ç‰ˆæœ¬ç­‰ï¼‰

### é¡¹ç›®æ‰€æœ‰æƒå£°æ˜
æ‰€æœ‰æ–°åˆ›å»ºçš„æ–‡ä»¶å¿…é¡»åŒ…å«é¡¹ç›®æ‰€æœ‰æƒå£°æ˜ï¼š
```typescript
/**
 * Project: claude-code-router
 * Owner: Jason Zhang
 * Created: [åˆ›å»ºæ—¥æœŸ]
 * Version: v2.6.0+
 */
```

## ğŸ” æ–‡ä»¶ç»´æŠ¤è§„åˆ™ (File Maintenance Rules)

### ä»£ç æ–‡ä»¶ç»´æŠ¤
- **è¡Œæ•°é™åˆ¶**: å•æ–‡ä»¶ä¸è¶…è¿‡500è¡Œä»£ç 
- **å‡½æ•°é•¿åº¦**: å•å‡½æ•°ä¸è¶…è¿‡50è¡Œä»£ç 
- **å¯¼å…¥ç®¡ç†**: ä¿æŒå¯¼å…¥è¯­å¥çš„æ•´æ´å’Œæœ‰åº
- **æ³¨é‡Šç»´æŠ¤**: å…³é”®é€»è¾‘å¿…é¡»æœ‰æ¸…æ™°æ³¨é‡Š

### é…ç½®æ–‡ä»¶ç»´æŠ¤
- **ç‰ˆæœ¬åŒæ­¥**: é…ç½®æ–‡ä»¶ç‰ˆæœ¬ä¸é¡¹ç›®ç‰ˆæœ¬åŒæ­¥
- **ç¤ºä¾‹æ›´æ–°**: é…ç½®æ¨¡æ¿æ–‡ä»¶åŠæ—¶æ›´æ–°
- **æ•æ„Ÿä¿¡æ¯**: ç»ä¸åœ¨é…ç½®æ¨¡æ¿ä¸­åŒ…å«çœŸå®å‡­æ®

### æ–‡æ¡£æ–‡ä»¶ç»´æŠ¤
- **å†…å®¹åŒæ­¥**: æ–‡æ¡£å†…å®¹ä¸å®é™…ä»£ç å®ç°åŒæ­¥
- **é“¾æ¥æ£€æŸ¥**: å®šæœŸæ£€æŸ¥æ–‡æ¡£ä¸­çš„é“¾æ¥æœ‰æ•ˆæ€§
- **æ ¼å¼ç»Ÿä¸€**: ä½¿ç”¨ç»Ÿä¸€çš„Markdownæ ¼å¼è§„èŒƒ

---
**æ–‡ä»¶ç»“æ„ç‰ˆæœ¬**: v2.6.0  
**ç»´æŠ¤è€…**: Jason Zhang  
**æœ€åæ›´æ–°**: 2025-08-01