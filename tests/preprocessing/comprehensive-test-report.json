{
  "timestamp": "2025-08-07T03:45:14.693Z",
  "totalDuration": 8081,
  "summary": {
    "totalTests": 5,
    "passedTests": 5,
    "failedTests": 0,
    "criticalFailures": 0,
    "successRate": "100.0%"
  },
  "testResults": [
    {
      "testName": "ç»¼åˆé¢„å¤„ç†ç®¡é“æµ‹è¯•",
      "script": "tests/preprocessing/test-comprehensive-preprocessing-pipeline.js",
      "passed": true,
      "duration": 29,
      "critical": true,
      "output": "ğŸ§ª [COMPREHENSIVE-PREPROCESSING-TEST] Starting comprehensive preprocessing pipeline test...\nğŸ“ Preprocessor path: /Users/fanzhang/Documents/github/claude-code-router/src/preprocessing/unified-patch-preprocessor.ts\n\nğŸš€ å¼€å§‹æ‰§è¡Œ 9 ä¸ªç»¼åˆé¢„å¤„ç†æµ‹è¯•ç”¨ä¾‹...\n\n\nğŸ“‹ æµ‹è¯•ç”¨ä¾‹: OpenAIå·¥å…·è°ƒç”¨finish_reasonä¿®å¤\n   Provider: openai, Model: gpt-4-turbo, Stage: response\n   âœ… é€šè¿‡ (1ms)\n   ğŸ“Š ç»“æœ: å·¥å…·æ£€æµ‹: 1ä¸ª, ä¿®æ”¹: 1é¡¹\n\nğŸ“‹ æµ‹è¯•ç”¨ä¾‹: ModelScopeç¼ºå¤±finish_reasonå¤„ç†\n   Provider: openai-key2, Model: qwen-turbo, Stage: response\n   ğŸ’¥ å¼‚å¸¸ (1ms): Silent failure detected and fixed\n   âœ… é¢„æœŸå¼‚å¸¸å¤„ç†æ­£ç¡®\n\nğŸ“‹ æµ‹è¯•ç”¨ä¾‹: Anthropicæ–‡æœ¬å·¥å…·è°ƒç”¨æ£€æµ‹\n   Provider: anthropic, Model: claude-3-sonnet-20240229, Stage: response\n   âœ… é€šè¿‡ (0ms)\n   ğŸ“Š ç»“æœ: å·¥å…·æ£€æµ‹: 2ä¸ª, ä¿®æ”¹: 1é¡¹\n\nğŸ“‹ æµ‹è¯•ç”¨ä¾‹: Geminiå‡½æ•°è°ƒç”¨finish_reasonä¿®å¤\n   Provider: gemini, Model: gemini-pro, Stage: response\n   âœ… é€šè¿‡ (0ms)\n   ğŸ“Š ç»“æœ: å·¥å…·æ£€æµ‹: 1ä¸ª, ä¿®æ”¹: 1é¡¹\n\nğŸ“‹ æµ‹è¯•ç”¨ä¾‹: OpenAIæµå¼å·¥å…·è°ƒç”¨å¤„ç†\n   Provider: openai, Model: gpt-4-turbo, Stage: streaming\n   âœ… é€šè¿‡ (0ms)\n   ğŸ“Š ç»“æœ: å·¥å…·æ£€æµ‹: 1ä¸ª, ä¿®æ”¹: 1é¡¹\n\nğŸ“‹ æµ‹è¯•ç”¨ä¾‹: GLMæ–‡æœ¬å·¥å…·è°ƒç”¨æ»‘åŠ¨çª—å£æ£€æµ‹\n   Provider: openai, Model: glm-4-plus, Stage: response\n   âœ… é€šè¿‡ (0ms)\n   ğŸ“Š ç»“æœ: å·¥å…·æ£€æµ‹: 1ä¸ª, ä¿®æ”¹: 1é¡¹\n\nğŸ“‹ æµ‹è¯•ç”¨ä¾‹: ç©ºå“åº”å¼‚å¸¸å¤„ç†\n   Provider: openai, Model: gpt-4, Stage: response\n   ğŸ’¥ å¼‚å¸¸ (0ms): Provider returned empty response\n   âœ… é¢„æœŸå¼‚å¸¸å¤„ç†æ­£ç¡®\n\nğŸ“‹ æµ‹è¯•ç”¨ä¾‹: HTTPé”™è¯¯å“åº”å¤„ç†\n   Provider: openai, Model: gpt-4, Stage: response\n   ğŸ’¥ å¼‚å¸¸ (0ms): Provider returned HTTP error response\n   âœ… é¢„æœŸå¼‚å¸¸å¤„ç†æ­£ç¡®\n\nğŸ“‹ æµ‹è¯•ç”¨ä¾‹: è¿æ¥è¶…æ—¶å“åº”å¤„ç†\n   Provider: openai, Model: gpt-4, Stage: response\n   ğŸ’¥ å¼‚å¸¸ (0ms): Provider connection or timeout error\n   âœ… é¢„æœŸå¼‚å¸¸å¤„ç†æ­£ç¡®\n\n================================================================================\nğŸ¯ ç»¼åˆé¢„å¤„ç†ç®¡é“æµ‹è¯•æ€»ç»“\n================================================================================\nğŸ“Š æ€»æµ‹è¯•æ•°: 9\nâœ… é€šè¿‡: 9\nâŒ å¤±è´¥: 0\nğŸ“ˆ æˆåŠŸç‡: 100.0%\n\nğŸ”§ æµ‹è¯•è¦†ç›–èŒƒå›´:\n   â€¢ OpenAIæ ¼å¼å·¥å…·è°ƒç”¨å’Œfinish_reasonä¿®å¤\n   â€¢ ModelScopeç¼ºå¤±finish_reasonå¼‚å¸¸å¤„ç†\n   â€¢ Anthropicæ–‡æœ¬å·¥å…·è°ƒç”¨æ£€æµ‹å’Œstop_reasonä¿®å¤\n   â€¢ Geminiå‡½æ•°è°ƒç”¨å’ŒfinishReasonä¿®å¤\n   â€¢ æµå¼å“åº”å·¥å…·è°ƒç”¨å¤„ç†\n   â€¢ æ»‘åŠ¨çª—å£æ–‡æœ¬å·¥å…·è°ƒç”¨æ£€æµ‹\n   â€¢ å¼‚å¸¸å“åº”å¤„ç†ï¼ˆç©ºå“åº”ã€HTTPé”™è¯¯ã€è¿æ¥è¶…æ—¶ï¼‰\n\nğŸ¯ é¢„å¤„ç†å™¨éªŒè¯ç»“æœ:\n   â€¢ å·¥å…·è°ƒç”¨æ£€æµ‹å‡†ç¡®æ€§: âœ…\n   â€¢ finish_reasonè‡ªåŠ¨ä¿®å¤: âœ…\n   â€¢ å¼‚å¸¸å“åº”å¤„ç†: âœ…\n   â€¢ å¤šProvideræ ¼å¼æ”¯æŒ: âœ…\n   â€¢ æ»‘åŠ¨çª—å£è§£æ: âœ…\n\nğŸ“„ è¯¦ç»†ç»“æœå·²ä¿å­˜åˆ°: /Users/fanzhang/Documents/github/claude-code-router/tests/preprocessing/comprehensive-preprocessing-test-results.json\n",
      "error": null,
      "summary": "æˆåŠŸç‡: 100.0%"
    },
    {
      "testName": "çœŸå®æ•°æ®æ¨¡æ‹Ÿæµ‹è¯•",
      "script": "tests/preprocessing/test-real-data-simulation.js",
      "passed": true,
      "duration": 30,
      "critical": true,
      "output": "ğŸ¯ [REAL-DATA-SIMULATION] Starting real data simulation test...\n\nğŸš€ å¼€å§‹æ‰§è¡Œ 10 ä¸ªçœŸå®æ•°æ®æ¨¡æ‹Ÿæµ‹è¯•...\n\n\nğŸ“‹ æµ‹è¯•æ ·æœ¬: openai_3456_tool_call_error\n   æ¥æº: Production Issue - Port 3456\n   æ—¶é—´: 2025-01-07T10:30:00Z\n   Provider: openai, Model: gpt-4-turbo-preview\n   âœ… é€šè¿‡ (0ms)\n   ğŸ“Š å¤„ç†ç»“æœ: å·¥å…·: 1ä¸ª, æ–¹æ³•: 1ç§, ä¿®æ”¹: 1é¡¹\n\nğŸ“‹ æµ‹è¯•æ ·æœ¬: modelscope_5507_missing_finish\n   æ¥æº: Production Issue - Port 5507\n   æ—¶é—´: 2025-01-07T11:15:00Z\n   Provider: openai-key2, Model: qwen-turbo\n   ğŸ’¥ å¼‚å¸¸ (1ms): ModelScope provider missing finish_reason field\n   âœ… é¢„æœŸå¼‚å¸¸å¤„ç†æ­£ç¡®\n\nğŸ“‹ æµ‹è¯•æ ·æœ¬: glm_text_tool_undetected\n   æ¥æº: Production Issue - GLM-4.5\n   æ—¶é—´: 2025-01-07T12:00:00Z\n   Provider: openai, Model: glm-4-plus\n   âœ… é€šè¿‡ (0ms)\n   ğŸ“Š å¤„ç†ç»“æœ: å·¥å…·: 1ä¸ª, æ–¹æ³•: 1ç§, ä¿®æ”¹: 1é¡¹\n\nğŸ“‹ æµ‹è¯•æ ·æœ¬: anthropic_text_tool_issue\n   æ¥æº: Production Issue - Claude\n   æ—¶é—´: 2025-01-07T13:30:00Z\n   Provider: anthropic, Model: claude-3-sonnet-20240229\n   âœ… é€šè¿‡ (1ms)\n   ğŸ“Š å¤„ç†ç»“æœ: å·¥å…·: 1ä¸ª, æ–¹æ³•: 1ç§, ä¿®æ”¹: 1é¡¹\n\nğŸ“‹ æµ‹è¯•æ ·æœ¬: gemini_function_call_error\n   æ¥æº: Production Issue - Gemini\n   æ—¶é—´: 2025-01-07T14:45:00Z\n   Provider: gemini, Model: gemini-pro\n   âœ… é€šè¿‡ (0ms)\n   ğŸ“Š å¤„ç†ç»“æœ: å·¥å…·: 1ä¸ª, æ–¹æ³•: 1ç§, ä¿®æ”¹: 1é¡¹\n\nğŸ“‹ æµ‹è¯•æ ·æœ¬: streaming_tool_call_issue\n   æ¥æº: Production Issue - Streaming\n   æ—¶é—´: 2025-01-07T15:20:00Z\n   Provider: openai, Model: gpt-4-turbo\n   âœ… é€šè¿‡ (0ms)\n   ğŸ“Š å¤„ç†ç»“æœ: å·¥å…·: 1ä¸ª, æ–¹æ³•: 1ç§, ä¿®æ”¹: 1é¡¹\n\nğŸ“‹ æµ‹è¯•æ ·æœ¬: complex_nested_tool_calls\n   æ¥æº: Production Issue - Complex Tools\n   æ—¶é—´: 2025-01-07T16:00:00Z\n   Provider: openai, Model: gpt-4-turbo\n   âœ… é€šè¿‡ (0ms)\n   ğŸ“Š å¤„ç†ç»“æœ: å·¥å…·: 3ä¸ª, æ–¹æ³•: 1ç§, ä¿®æ”¹: 1é¡¹\n\nğŸ“‹ æµ‹è¯•æ ·æœ¬: empty_response_error\n   æ¥æº: Production Issue - Empty Response\n   æ—¶é—´: 2025-01-07T17:15:00Z\n   Provider: openai, Model: gpt-4\n   ğŸ’¥ å¼‚å¸¸ (0ms): Provider returned empty response\n   âœ… é¢„æœŸå¼‚å¸¸å¤„ç†æ­£ç¡®\n\nğŸ“‹ æµ‹è¯•æ ·æœ¬: rate_limit_error\n   æ¥æº: Production Issue - Rate Limit\n   æ—¶é—´: 2025-01-07T18:00:00Z\n   Provider: openai, Model: gpt-4\n   ğŸ’¥ å¼‚å¸¸ (0ms): Provider returned HTTP error response\n   âœ… é¢„æœŸå¼‚å¸¸å¤„ç†æ­£ç¡®\n\nğŸ“‹ æµ‹è¯•æ ·æœ¬: connection_timeout_error\n   æ¥æº: Production Issue - Timeout\n   æ—¶é—´: 2025-01-07T19:30:00Z\n   Provider: openai, Model: gpt-4\n   ğŸ’¥ å¼‚å¸¸ (0ms): Provider connection or timeout error\n   âœ… é¢„æœŸå¼‚å¸¸å¤„ç†æ­£ç¡®\n\n================================================================================\nğŸ¯ çœŸå®æ•°æ®æ¨¡æ‹Ÿæµ‹è¯•è¯¦ç»†æ€»ç»“\n================================================================================\nğŸ“Š æ€»æµ‹è¯•æ•°: 10\nâœ… é€šè¿‡: 10\nâŒ å¤±è´¥: 0\nğŸ“ˆ æˆåŠŸç‡: 100.0%\n\nğŸ“‹ é—®é¢˜ç±»å‹åˆ†å¸ƒ:\n   â€¢ other: 7/7 (100.0%)\n   â€¢ error_handling: 3/3 (100.0%)\n\nâœ… æˆåŠŸå¤„ç†çš„å…³é”®æ¡ˆä¾‹:\n   â€¢ openai_3456_tool_call_error: å·¥å…·: 1ä¸ª, æ–¹æ³•: 1ç§, ä¿®æ”¹: 1é¡¹\n   â€¢ modelscope_5507_missing_finish: å¤„ç†æˆåŠŸ\n   â€¢ glm_text_tool_undetected: å·¥å…·: 1ä¸ª, æ–¹æ³•: 1ç§, ä¿®æ”¹: 1é¡¹\n   â€¢ anthropic_text_tool_issue: å·¥å…·: 1ä¸ª, æ–¹æ³•: 1ç§, ä¿®æ”¹: 1é¡¹\n   â€¢ gemini_function_call_error: å·¥å…·: 1ä¸ª, æ–¹æ³•: 1ç§, ä¿®æ”¹: 1é¡¹\n\nğŸ”§ é¢„å¤„ç†å™¨éªŒè¯è¦†ç›–:\n   â€¢ OpenAIå·¥å…·è°ƒç”¨finish_reasonæ˜ å°„é”™è¯¯ä¿®å¤\n   â€¢ ModelScopeç¼ºå¤±finish_reasonå¼‚å¸¸æ£€æµ‹\n   â€¢ GLM-4.5æ–‡æœ¬æ ¼å¼å·¥å…·è°ƒç”¨æ»‘åŠ¨çª—å£æ£€æµ‹\n   â€¢ Anthropicæ–‡æœ¬å·¥å…·è°ƒç”¨stop_reasonä¿®å¤\n   â€¢ Geminiå‡½æ•°è°ƒç”¨finishReasonä¿®å¤\n   â€¢ æµå¼å“åº”å·¥å…·è°ƒç”¨å¤„ç†\n   â€¢ å¤æ‚åµŒå¥—å·¥å…·è°ƒç”¨æ£€æµ‹\n   â€¢ å¼‚å¸¸å“åº”å¤„ç†ï¼ˆç©ºå“åº”ã€é€Ÿç‡é™åˆ¶ã€è¿æ¥è¶…æ—¶ï¼‰\n\nğŸ“„ è¯¦ç»†ç»“æœå·²ä¿å­˜åˆ°: /Users/fanzhang/Documents/github/claude-code-router/tests/preprocessing/real-data-simulation-results.json\nğŸ“‹ é—®é¢˜åˆ†ææŠ¥å‘Šå·²ç”Ÿæˆ: /Users/fanzhang/Documents/github/claude-code-router/tests/preprocessing/production-issue-analysis-report.md\n",
      "error": null,
      "summary": "æˆåŠŸç‡: 100.0%"
    },
    {
      "testName": "finish_reasonä¿®å¤éªŒè¯",
      "script": "scripts/test-finish-reason-parsing-simulation.js",
      "passed": true,
      "duration": 29,
      "critical": false,
      "output": "ğŸ§ª å¼€å§‹Finish Reasonè§£ææ¨¡æ‹Ÿæµ‹è¯•...\nğŸ“Š æ€»æµ‹è¯•ç”¨ä¾‹: 8\n\nğŸ”¬ æµ‹è¯• 1/8: å·¥å…·è°ƒç”¨è¢«é”™è¯¯æ˜ å°„ä¸ºstop\n   âœ… é€šè¿‡ (0ms)\n      åŸå§‹finish_reason: stop\n      ä¿®æ­£finish_reason: tool_calls\n      æ˜¯å¦ä¿®æ­£: æ˜¯\n      å·¥å…·è°ƒç”¨æ£€æµ‹: æ˜¯ (1)\n      æ£€æµ‹æ–¹æ³•: message_tool_calls\n      æ£€æµ‹ç½®ä¿¡åº¦: 1\n      ğŸ”§ æ­£ç¡®åº”ç”¨äº†ä¿®æ­£\n\nğŸ”¬ æµ‹è¯• 2/8: æµå¼å“åº”ä¸­å·¥å…·è°ƒç”¨finish_reasoné”™è¯¯\n   âœ… é€šè¿‡ (0ms)\n      åŸå§‹finish_reason: stop\n      ä¿®æ­£finish_reason: tool_calls\n      æ˜¯å¦ä¿®æ­£: æ˜¯\n      å·¥å…·è°ƒç”¨æ£€æµ‹: æ˜¯ (1)\n      æ£€æµ‹æ–¹æ³•: delta_tool_calls\n      æ£€æµ‹ç½®ä¿¡åº¦: 1\n      ğŸ”§ æ­£ç¡®åº”ç”¨äº†ä¿®æ­£\n\nğŸ”¬ æµ‹è¯• 3/8: å·¥å…·è°ƒç”¨é”™è¯¯åœ°å‡ºç°åœ¨æ–‡æœ¬å†…å®¹ä¸­\n   âœ… é€šè¿‡ (0ms)\n      åŸå§‹finish_reason: stop\n      ä¿®æ­£finish_reason: tool_calls\n      æ˜¯å¦ä¿®æ­£: æ˜¯\n      å·¥å…·è°ƒç”¨æ£€æµ‹: æ˜¯ (1)\n      æ£€æµ‹æ–¹æ³•: text_detection_text_tool_call_format\n      æ£€æµ‹ç½®ä¿¡åº¦: 0.95\n      ğŸ”§ æ­£ç¡®åº”ç”¨äº†ä¿®æ­£\n\nğŸ”¬ æµ‹è¯• 4/8: æ­£ç¡®çš„å·¥å…·è°ƒç”¨å“åº”\n   âœ… é€šè¿‡ (0ms)\n      åŸå§‹finish_reason: tool_calls\n      ä¿®æ­£finish_reason: tool_calls\n      æ˜¯å¦ä¿®æ­£: å¦\n      å·¥å…·è°ƒç”¨æ£€æµ‹: æ˜¯ (1)\n      æ£€æµ‹æ–¹æ³•: message_tool_calls\n      æ£€æµ‹ç½®ä¿¡åº¦: 1\n      âœ… æ­£ç¡®ä¿æŒäº†åŸå€¼\n\nğŸ”¬ æµ‹è¯• 5/8: æ™®é€šæ–‡æœ¬å“åº”\n   âœ… é€šè¿‡ (0ms)\n      åŸå§‹finish_reason: stop\n      ä¿®æ­£finish_reason: stop\n      æ˜¯å¦ä¿®æ­£: å¦\n      å·¥å…·è°ƒç”¨æ£€æµ‹: å¦ (0)\n      æ£€æµ‹æ–¹æ³•: none\n      æ£€æµ‹ç½®ä¿¡åº¦: 0\n      âœ… æ­£ç¡®ä¿æŒäº†åŸå€¼\n\nğŸ”¬ æµ‹è¯• 6/8: å¤šä¸ªå·¥å…·è°ƒç”¨ä½†finish_reasoné”™è¯¯\n   âœ… é€šè¿‡ (0ms)\n      åŸå§‹finish_reason: stop\n      ä¿®æ­£finish_reason: tool_calls\n      æ˜¯å¦ä¿®æ­£: æ˜¯\n      å·¥å…·è°ƒç”¨æ£€æµ‹: æ˜¯ (2)\n      æ£€æµ‹æ–¹æ³•: message_tool_calls\n      æ£€æµ‹ç½®ä¿¡åº¦: 1\n      ğŸ”§ æ­£ç¡®åº”ç”¨äº†ä¿®æ­£\n\nğŸ”¬ æµ‹è¯• 7/8: ç©ºçš„tool_callsæ•°ç»„\n   âœ… é€šè¿‡ (0ms)\n      åŸå§‹finish_reason: stop\n      ä¿®æ­£finish_reason: stop\n      æ˜¯å¦ä¿®æ­£: å¦\n      å·¥å…·è°ƒç”¨æ£€æµ‹: å¦ (0)\n      æ£€æµ‹æ–¹æ³•: none\n      æ£€æµ‹ç½®ä¿¡åº¦: 0\n      âœ… æ­£ç¡®ä¿æŒäº†åŸå€¼\n\nğŸ”¬ æµ‹è¯• 8/8: Anthropicæ ¼å¼çš„å·¥å…·è°ƒç”¨å‡ºç°åœ¨æ–‡æœ¬ä¸­\n   âœ… é€šè¿‡ (1ms)\n      åŸå§‹finish_reason: stop\n      ä¿®æ­£finish_reason: tool_calls\n      æ˜¯å¦ä¿®æ­£: æ˜¯\n      å·¥å…·è°ƒç”¨æ£€æµ‹: æ˜¯ (1)\n      æ£€æµ‹æ–¹æ³•: text_detection_anthropic_json_format\n      æ£€æµ‹ç½®ä¿¡åº¦: 0.95\n      ğŸ”§ æ­£ç¡®åº”ç”¨äº†ä¿®æ­£\n\n============================================================\nğŸ“Š Finish Reasonè§£ææ¨¡æ‹Ÿæµ‹è¯•æŠ¥å‘Š\n============================================================\n\nğŸ“ˆ æ€»ä½“ç»Ÿè®¡:\n   æ€»æµ‹è¯•æ•°: 8\n   é€šè¿‡: 8 (100.0%)\n   å¤±è´¥: 0 (0.0%)\n\nğŸ”§ ä¿®æ­£æ•ˆæœç»Ÿè®¡:\n   åº”è¯¥ä¿®æ­£: 5 ä¸ª\n   å®é™…ä¿®æ­£: 5 ä¸ª\n   æ­£ç¡®ä¿®æ­£: 5 ä¸ª\n   æ­£ç¡®ä¿æŒ: 3 ä¸ª\n\nğŸ” æ£€æµ‹æ–¹æ³•åˆ†å¸ƒ:\n   message_tool_calls: 3 æ¬¡\n   delta_tool_calls: 1 æ¬¡\n   text_detection_text_tool_call_format: 1 æ¬¡\n   none: 2 æ¬¡\n   text_detection_anthropic_json_format: 1 æ¬¡\n\nğŸ’¡ æ”¹è¿›å»ºè®®:\n   ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼ä¿®å¤é€»è¾‘å·¥ä½œæ­£å¸¸\n\nğŸ› ï¸  å»ºè®®çš„ä¼˜åŒ–æ–¹å‘:\n   1. å¢å¼ºæ–‡æœ¬æ¨¡å¼æ£€æµ‹çš„å‡†ç¡®æ€§\n   2. ä¼˜åŒ–æµå¼å“åº”çš„å·¥å…·è°ƒç”¨æ£€æµ‹\n   3. æ·»åŠ æ›´å¤šè¾¹ç¼˜æƒ…å†µçš„å¤„ç†\n   4. æé«˜æ£€æµ‹ç½®ä¿¡åº¦çš„è®¡ç®—ç²¾åº¦\n\nğŸ“„ è¯¦ç»†æŠ¥å‘Šå·²ä¿å­˜: /tmp/finish-reason-parsing-simulation-report-1754538306700.json\n",
      "error": null,
      "summary": "æ€»æµ‹è¯•: 8"
    },
    {
      "testName": "å·¥å…·è°ƒç”¨æ£€æµ‹éªŒè¯",
      "script": "scripts/test-tool-call-detection-comprehensive.js",
      "passed": true,
      "duration": 7960,
      "critical": false,
      "output": "ğŸ§ª å¼€å§‹ç»¼åˆå·¥å…·è°ƒç”¨æ£€æµ‹æµ‹è¯•...\nğŸ“Š æ€»æµ‹è¯•ç”¨ä¾‹: 6\n\nğŸ”¬ æµ‹è¯• 1/6: æ˜ç¡®çš„å·¥å…·è°ƒç”¨è¯·æ±‚\n\nğŸ”¬ æµ‹è¯• 2/6: å¤šå·¥å…·è°ƒç”¨è¯·æ±‚\n\nğŸ”¬ æµ‹è¯• 3/6: æ— å·¥å…·è°ƒç”¨çš„æ™®é€šæ–‡æœ¬è¯·æ±‚\n\nğŸ”¬ æµ‹è¯• 4/6: æœ‰å·¥å…·å®šä¹‰ä½†ä¸éœ€è¦è°ƒç”¨\n\nğŸ”¬ æµ‹è¯• 5/6: ä¸­æ–‡å·¥å…·è°ƒç”¨è¯·æ±‚\n\nğŸ”¬ æµ‹è¯• 6/6: å¤æ‚å‚æ•°çš„å·¥å…·è°ƒç”¨\n\n============================================================\nğŸ“Š ç»¼åˆå·¥å…·è°ƒç”¨æ£€æµ‹æµ‹è¯•æŠ¥å‘Š\n============================================================\n\nğŸ“ˆ æ€»ä½“ç»Ÿè®¡:\n   æ€»æµ‹è¯•æ•°: 6\n   é€šè¿‡: 0 (0.0%)\n   å¤±è´¥: 6 (100.0%)\n\nğŸ” å¤±è´¥åŸå› åˆ†æ:\n   â€¢ Request failed with status code 500: 6 æ¬¡\n\nğŸ“‹ Finish Reasonåˆ†å¸ƒ:\n\nğŸ”§ å·¥å…·è°ƒç”¨æ£€æµ‹ç»Ÿè®¡:\n   æœŸæœ›æœ‰å·¥å…·è°ƒç”¨: 4\n   å®é™…æ£€æµ‹åˆ°å·¥å…·è°ƒç”¨: 0\n   æ£€æµ‹æ­£ç¡®: 0 (0.0%)\n\nğŸ’¡ æ”¹è¿›å»ºè®®:\n   ğŸ“Š å»ºè®®è¿è¡Œä¿®å¤è„šæœ¬: node scripts/fix-tool-call-finish-reason.js\n   ğŸ” å»ºè®®åˆ†ææ—¥å¿—: node scripts/analyze-tool-call-detection-issues.js\n\nğŸ“„ è¯¦ç»†æŠ¥å‘Šå·²ä¿å­˜: /tmp/tool-call-detection-test-report-1754538314660.json\n   âŒ è¯·æ±‚å¤±è´¥: Request failed with status code 500\n   âŒ è¯·æ±‚å¤±è´¥: Request failed with status code 500\n   âŒ è¯·æ±‚å¤±è´¥: Request failed with status code 500\n   âŒ è¯·æ±‚å¤±è´¥: Request failed with status code 500\n   âŒ è¯·æ±‚å¤±è´¥: Request failed with status code 500\n   âŒ è¯·æ±‚å¤±è´¥: Request failed with status code 500\n",
      "error": null,
      "summary": "æ€»æµ‹è¯•: 6"
    },
    {
      "testName": "OpenAIçœŸå®å“åº”æ¨¡æ‹Ÿ",
      "script": "scripts/test-real-openai-response-simulation.js",
      "passed": true,
      "duration": 30,
      "critical": false,
      "output": "ğŸ§ª å¼€å§‹çœŸå®OpenAIå“åº”æ¨¡æ‹Ÿæµ‹è¯•...\nğŸ“Š æ€»æµ‹è¯•ç”¨ä¾‹: 8\n\nğŸ”¬ æµ‹è¯• 1/8: å®Œæ•´çš„å·¥å…·è°ƒç”¨å“åº”ä½†finish_reasoné”™è¯¯\n   âœ… é€šè¿‡ (0ms)\n      å“åº”ID: chatcmpl-abc123\n      æ¨¡å‹: gpt-4\n      åŸå§‹finish_reason: stop\n      æœ€ç»ˆfinish_reason: tool_calls\n      å·¥å…·è°ƒç”¨æ£€æµ‹: æ˜¯ (1)\n      æ£€æµ‹æ–¹æ³•: message_tool_calls\n      æ˜¯å¦ä¿®æ­£: æ˜¯\n      ğŸ”§ æ­£ç¡®åº”ç”¨äº†ä¿®æ­£\n\nğŸ”¬ æµ‹è¯• 2/8: æµå¼å“åº”æœ€åchunkçš„finish_reasoné”™è¯¯\n   âœ… é€šè¿‡ (0ms)\n      å“åº”ID: chatcmpl-stream123\n      æ¨¡å‹: gpt-4\n      åŸå§‹finish_reason: stop\n      æœ€ç»ˆfinish_reason: tool_calls\n      å·¥å…·è°ƒç”¨æ£€æµ‹: æ˜¯ (1)\n      æ£€æµ‹æ–¹æ³•: delta_tool_calls\n      æ˜¯å¦ä¿®æ­£: æ˜¯\n      ğŸ”§ æ­£ç¡®åº”ç”¨äº†ä¿®æ­£\n\nğŸ”¬ æµ‹è¯• 3/8: å·¥å…·è°ƒç”¨æ³„éœ²åˆ°contentå­—æ®µä¸­\n   âœ… é€šè¿‡ (0ms)\n      å“åº”ID: chatcmpl-leak789\n      æ¨¡å‹: gpt-4\n      åŸå§‹finish_reason: stop\n      æœ€ç»ˆfinish_reason: tool_calls\n      å·¥å…·è°ƒç”¨æ£€æµ‹: æ˜¯ (1)\n      æ£€æµ‹æ–¹æ³•: text_detection_text_tool_call\n      æ˜¯å¦ä¿®æ­£: æ˜¯\n      ğŸ”§ æ­£ç¡®åº”ç”¨äº†ä¿®æ­£\n\nğŸ”¬ æµ‹è¯• 4/8: å¤šä¸ªå·¥å…·è°ƒç”¨çš„å¤æ‚åœºæ™¯\n   âœ… é€šè¿‡ (0ms)\n      å“åº”ID: chatcmpl-multi123\n      æ¨¡å‹: gpt-4\n      åŸå§‹finish_reason: stop\n      æœ€ç»ˆfinish_reason: tool_calls\n      å·¥å…·è°ƒç”¨æ£€æµ‹: æ˜¯ (3)\n      æ£€æµ‹æ–¹æ³•: message_tool_calls\n      æ˜¯å¦ä¿®æ­£: æ˜¯\n      ğŸ”§ æ­£ç¡®åº”ç”¨äº†ä¿®æ­£\n\nğŸ”¬ æµ‹è¯• 5/8: æ­£ç¡®çš„å·¥å…·è°ƒç”¨å“åº”\n   âœ… é€šè¿‡ (0ms)\n      å“åº”ID: chatcmpl-correct456\n      æ¨¡å‹: gpt-4\n      åŸå§‹finish_reason: tool_calls\n      æœ€ç»ˆfinish_reason: tool_calls\n      å·¥å…·è°ƒç”¨æ£€æµ‹: æ˜¯ (1)\n      æ£€æµ‹æ–¹æ³•: message_tool_calls\n      æ˜¯å¦ä¿®æ­£: å¦\n      âœ… æ­£ç¡®ä¿æŒäº†åŸå€¼\n\nğŸ”¬ æµ‹è¯• 6/8: æ­£å¸¸çš„æ–‡æœ¬å“åº”\n   âœ… é€šè¿‡ (0ms)\n      å“åº”ID: chatcmpl-text123\n      æ¨¡å‹: gpt-4\n      åŸå§‹finish_reason: stop\n      æœ€ç»ˆfinish_reason: stop\n      å·¥å…·è°ƒç”¨æ£€æµ‹: å¦ (0)\n      æ£€æµ‹æ–¹æ³•: none\n      æ˜¯å¦ä¿®æ­£: å¦\n      âœ… æ­£ç¡®ä¿æŒäº†åŸå€¼\n\nğŸ”¬ æµ‹è¯• 7/8: max_tokensé™åˆ¶ä½†æœ‰å·¥å…·è°ƒç”¨\n   âœ… é€šè¿‡ (0ms)\n      å“åº”ID: chatcmpl-maxtoken789\n      æ¨¡å‹: gpt-4\n      åŸå§‹finish_reason: length\n      æœ€ç»ˆfinish_reason: length\n      å·¥å…·è°ƒç”¨æ£€æµ‹: æ˜¯ (1)\n      æ£€æµ‹æ–¹æ³•: message_tool_calls\n      æ˜¯å¦ä¿®æ­£: å¦\n      âœ… æ­£ç¡®ä¿æŒäº†åŸå€¼\n\nğŸ”¬ æµ‹è¯• 8/8: Anthropicæ ¼å¼æ··å…¥OpenAIå“åº”\n   âœ… é€šè¿‡ (0ms)\n      å“åº”ID: chatcmpl-mixed456\n      æ¨¡å‹: gpt-4\n      åŸå§‹finish_reason: stop\n      æœ€ç»ˆfinish_reason: tool_calls\n      å·¥å…·è°ƒç”¨æ£€æµ‹: æ˜¯ (1)\n      æ£€æµ‹æ–¹æ³•: text_detection_anthropic_json\n      æ˜¯å¦ä¿®æ­£: æ˜¯\n      ğŸ”§ æ­£ç¡®åº”ç”¨äº†ä¿®æ­£\n\n============================================================\nğŸ“Š çœŸå®OpenAIå“åº”æ¨¡æ‹Ÿæµ‹è¯•æŠ¥å‘Š\n============================================================\n\nğŸ“ˆ æ€»ä½“ç»Ÿè®¡:\n   æ€»æµ‹è¯•æ•°: 8\n   é€šè¿‡: 8 (100.0%)\n   å¤±è´¥: 0 (0.0%)\n\nğŸ“‹ å“åº”ç±»å‹åˆ†å¸ƒ:\n   æµå¼å“åº”: 1\n   éæµå¼å“åº”: 7\n   åŒ…å«å·¥å…·è°ƒç”¨: 7\n   ä¸å«å·¥å…·è°ƒç”¨: 1\n\nğŸ”§ ä¿®æ­£æ•ˆæœç»Ÿè®¡:\n   åº”è¯¥ä¿®æ­£: 5 ä¸ª\n   å®é™…ä¿®æ­£: 5 ä¸ª\n   æ­£ç¡®ä¿®æ­£: 5 ä¸ª\n   æ­£ç¡®ä¿æŒ: 3 ä¸ª\n\nğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼OpenAI finish_reasonä¿®å¤é€»è¾‘å·¥ä½œå®Œç¾ï¼\n\nğŸ“„ è¯¦ç»†æŠ¥å‘Šå·²ä¿å­˜: /tmp/real-openai-response-simulation-report-1754538314690.json\n",
      "error": null,
      "summary": "æ€»æµ‹è¯•: 8"
    }
  ],
  "coverage": {
    "preprocessingPipeline": true,
    "realDataSimulation": true,
    "finishReasonFix": true,
    "toolCallDetection": true,
    "openaiSimulation": true
  },
  "recommendations": [
    "âœ… æ‰€æœ‰æµ‹è¯•è¡¨ç°è‰¯å¥½ï¼Œé¢„å¤„ç†å™¨åŠŸèƒ½æ­£å¸¸"
  ]
}